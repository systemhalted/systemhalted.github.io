---
layout: page
title: Categories
description: "An archive of posts sorted by categories."
permalink: /categories/
---

{% assign themes = site.data.taxonomy.themes %}

{% for theme in themes %}
  {%- comment -%}
    Compute how many posts exist across all categories in this theme
  {%- endcomment -%}
  {% assign total_posts = 0 %}
  {% for cat in theme.categories %}
    {% assign posts = site.categories[cat] %}
    {% if posts %}
      {% assign post_count = posts | size %}
      {% assign total_posts = total_posts | plus: post_count %}
    {% endif %}
  {% endfor %}

  {% if total_posts > 0 %}
    <h2 id="{{ theme.id }}">{{ theme.title }}</h2>

    {% if theme.description %}
      <p>{{ theme.description }}</p>
    {% endif %}

    {% for cat in theme.categories %}
      {% assign posts = site.categories[cat] %}
      {% if posts %}
        {% assign posts = posts | sort: "date" | reverse %}
      {% endif %}
      {% if posts and posts.size > 0 %}
        <details id="cat-{{ cat | slugify }}" class="archive-year">
          <summary class="archive-year-summary">
            <span class="archive-year-title">{{ cat }}</span>
            <span class="archive-year-count">({{ posts.size }})</span>
          </summary>
          <ul class="archive-posts">
            {% for post in posts %}
              {% assign post_summary = post.description | default: post.excerpt | strip_html | strip_newlines | truncatewords: 40 %}
              <li class="archive-post">
                <details class="archive-post-details">
                  <summary class="archive-post-summary">
                    <span class="archive-post-meta">
                      <time class="post-list-date" datetime="{{ post.date | date_to_xmlschema }}" itemprop="datePublished">{{ post.date | date: "%B %d, %Y" }}</time>
                      <a class="archive-post-title" href="{{ post.url | relative_url }}">{{ post.title }}</a>
                    </span>
                  </summary>
                  {% if post_summary and post_summary != "" %}
                    <p class="archive-post-description">{{ post_summary }}</p>
                  {% endif %}
                </details>
              </li>
            {% endfor %}
          </ul>
        </details>
      {% endif %}
    {% endfor %}
  {% endif %}
{% endfor %}

<h2>Other categories</h2>

{% assign taxonomy_cats = "" | split: "," %}
{% for theme in themes %}
  {% assign taxonomy_cats = taxonomy_cats | concat: theme.categories %}
{% endfor %}

{% for cat in site.categories %}
  {% assign cat_name = cat[0] %}
  {% assign posts = cat[1] | sort: "date" | reverse %}
  {% assign in_taxonomy = false %}

  {% if taxonomy_cats contains cat_name %}
    {% assign in_taxonomy = true %}
  {% endif %}

  {% unless in_taxonomy %}
    <details id="cat-{{ cat_name | slugify }}" class="archive-year">
      <summary class="archive-year-summary">
        <span class="archive-year-title">{{ cat_name }}</span>
        <span class="archive-year-count">({{ posts.size }})</span>
      </summary>

      <ul class="archive-posts">
        {% for post in posts %}
          {% assign post_summary = post.description | default: post.excerpt | strip_html | strip_newlines | truncatewords: 40 %}
          <li class="archive-post">
            <details class="archive-post-details">
              <summary class="archive-post-summary">
                <span class="archive-post-meta">
                  <time class="post-list-date" datetime="{{ post.date | date_to_xmlschema }}" itemprop="datePublished">{{ post.date | date: "%B %d, %Y" }}</time>
                  <a class="archive-post-title" href="{{ post.url | relative_url }}">{{ post.title }}</a>
                </span>
              </summary>
              {% if post_summary and post_summary != "" %}
                <p class="archive-post-description">{{ post_summary }}</p>
              {% endif %}
            </details>
          </li>
        {% endfor %}
      </ul>
    </details>
  {% endunless %}
{% endfor %}
